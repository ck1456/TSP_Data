<project name="CityViewer" basedir="." default="package">

	<property name="src.dir" value="src" />
	<property name="build.dir" value="bin" />
	<property name="project.home" location="." />

	<target name="clean">
		<delete dir="${build.dir}" />
	</target>

	<target name="compile">
		<javac srcdir="${src.dir}" destdir="${build.dir}" compiler="modern" fork="true" includeantruntime="false" />
	</target>

	<property name="build.output.dir" value="C:\java_sign" />
	<property name="key.store" value="${build.output.dir}/.keystore" />
	<property name="key.storepass" value="myreallysecretpassword" />
	<property name="key.alias" value="ck1456" />
	<property name="key.pass" value="badass" />

	<target name="createjar" depends="compile">
		<jar destfile="${project.home}/CityViewer.jar" baseDir="${project.home}/bin">
			<manifest>
				<attribute name="Main-Class" value="hps.nyu.fa14.MapApplet" />
			</manifest>
		</jar>

		<signjar jar="${project.home}/CityViewer.jar" alias="${key.alias}" storepass="${key.storepass}" />

	</target>

	<target name="simplejar" depends="compile">
		<jar destfile="${project.home}/SimpleTraveler.jar" baseDir="${project.home}/bin">
			<manifest>
				<attribute name="Main-Class" value="hps.nyu.fa14.SimpleTraveler" />
			</manifest>
		</jar>
	</target>

	<!--
	<target name="genKeystore">
		<mkdir dir="${build.output.dir}" />
		<genkey alias="${verisign.key.alias}" verbose="true" storepass="${verisign.key.storepass}" keypass="${verisign.key.pass}" validity="365" keystore="${verisign.key.store}">
			<dname>
				<param name="CN" value="AsJava.com Group" />
				<param name="OU" value="Jim" />
				<param name="O" value="AsJava.com" />
				<param name="C" value="US" />
			</dname>
		</genkey>
	</target>
-->
	<target name="genKey">
		<genkey alias="${key.alias}" verbose="true" storepass="${key.storepass}">
			<dname>
				<param name="CN" value="Chris Keitel" />
				<param name="OU" value="NYU-HPS" />
				<param name="O" value="NYU" />
				<param name="C" value="US" />
			</dname>
		</genkey>
	</target>


	<property name="zip.name" value="CityViewer" />
	<target name="package" depends="createjar">
		<echo>Zipping...</echo>
		<zip destfile="dist/${zip.name}.zip">
			<zipfileset dir="." includes="index.html" prefix="${zip.name}" />
			<zipfileset dir="src" includes="*.java" prefix="${zip.name}" excludes="test*.java" />
			<zipfileset dir="bin" includes="*.class" prefix="${zip.name}" excludes="test*.class" />
		</zip>
	</target>

</project>
